A. Tabla Existente: users (Identidad y Acceso)
Recomendaci√≥n de Alteraci√≥n: Alterar la columna rol y la obligatoriedad de campos.

Campo	Tipo	Nullable	Valor Inicial/Cambio Sugerido	Prop√≥sito
id	INTEGER	NOT NULL		PK
email	VARCHAR	NOT NULL		Login/Contacto principal.
rol	VARCHAR(50)	NOT NULL	MODIFICACI√ìN: Inicia como 'PENDIENTE_PAGO' o 'VISUALIZADOR_LIMITADO'. Solo cambia a 'editor' tras la verificaci√≥n del pago.	
first_name	VARCHAR	NOT NULL	ALTERACI√ìN: Poner como NOT NULL.	
last_name	VARCHAR	NOT NULL	ALTERACI√ìN: Poner como NOT NULL.	
telefono	VARCHAR(20)	NOT NULL	ALTERACI√ìN: Poner como NOT NULL.	
direccion	TEXT	NOT NULL	ALTERACI√ìN: Poner como NOT NULL.	
cedula	TEXT	NOT NULL	ALTERACI√ìN: Poner como NOT NULL.	
ruc	VARCHAR(20)	NULL	MANTENER/A√ëADIR: Opcional en registro, obligatorio en facturaci√≥n.	

Exportar a Hojas de c√°lculo
B. Tabla Nueva: planes (Estructura de Precios)
Define la l√≥gica de costos y cuentas.

Campo	Tipo	Ejemplo de Dato	Prop√≥sito
id_plan	SERIAL PRIMARY KEY	1	Identificador √∫nico del plan.
nombre_plan	VARCHAR	"Mini Broker Anual"	Nombre del plan agrupado.
recurrencia	VARCHAR	'Anual', 'Mensual'	Per√≠odo de facturaci√≥n.
costo_total	NUMERIC(10, 2)	18270000	Precio final que el usuario debe pagar.
max_cuentas	INTEGER	1, 5, 10...	L√≠mite de usuarios (editores) que este plan incluye.

Exportar a Hojas de c√°lculo
C. Tabla Nueva: usuarios_suscripciones (Control de Pedidos y Activaci√≥n/Desactivaci√≥n)
Esta es la tabla central del flujo de pago y renovaci√≥n, dise√±ada para el control manual del administrador.

Campo	Tipo	Prop√≥sito
id_suscripcion	SERIAL PRIMARY KEY	ID de la transacci√≥n.
id_usuario_principal	INTEGER (FK)	El usuario que realiza el pago.
id_plan	INTEGER (FK)	Enlace al plan y costo adquirido.
monto_transferido	NUMERIC(10, 2)	El monto reportado por el usuario.
comprobante_url	VARCHAR(255)	Ruta/URL del comprobante de dep√≥sito digital. (M√≥dulo de Subida).
estado	VARCHAR(30)	CLAVE para el panel de control: PENDIENTE_VERIFICACION, ACTIVO, EXPIRADO, CANCELADO.
fecha_pago_reportada	DATE	Fecha que el usuario dice haber pagado.
fecha_habilitacion	TIMESTAMP	Inicio del per√≠odo de servicio (Activaci√≥n por Admin).
fecha_vencimiento	DATE	Fin del per√≠odo. Usada para la Desactivaci√≥n Autom√°tica (si NOW() > fecha_vencimiento, el sistema cambia users.rol a 'EXPIRADO').
id_admin_verificador	INTEGER (FK)	ID del administrador que verific√≥ el pago.

Exportar a Hojas de c√°lculo
D. Tabla Nueva: facturacion_datos (Datos Fiscales)
Almacena los datos necesarios para emitir la Nota Fiscal, desvincul√°ndolos de la tabla users para mayor flexibilidad.

Campo	Tipo	Nullable	Prop√≥sito
id_usuario	INTEGER (PK/FK)	NOT NULL	Enlace al usuario principal (1:1).
ruc_fiscal	VARCHAR(20)	NOT NULL	RUC para la facturaci√≥n.
razon_social	VARCHAR(255)	NOT NULL	Nombre o raz√≥n social.
direccion_fiscal	TEXT	NULL	Direcci√≥n para el env√≠o f√≠sico.
metodo_entrega	VARCHAR(50)	NOT NULL	'Digital', 'Postal', 'Correo Convencional'.
email_facturacion	VARCHAR(100)	NULL	Email dedicado a la factura.

Exportar a Hojas de c√°lculo
E. Tabla Nueva: suscripcion_cuentas_gestion (Gesti√≥n de Multi-Cuentas)
Permite al administrador principal del plan invitar o gestionar sus cuentas secundarias.

Campo	Tipo	Nullable	Prop√≥sito
id_registro	SERIAL PRIMARY KEY	NOT NULL	ID del registro.
id_suscripcion	INTEGER (FK)	NOT NULL	El pago que habilita esta cuenta.
id_usuario_secundario	INTEGER (FK)	NULL	Enlace a users.id si ya existe.
email_invitado	VARCHAR(100)	NOT NULL	Email para la invitaci√≥n.
estado_invitacion	VARCHAR(30)	NOT NULL	'PENDIENTE_INVITACION', 'ACEPTADA', 'RECHAZADA'.

Exportar a Hojas de c√°lculo
2. üõ°Ô∏è Flujo de Control para el Administrador
El sistema requiere un Panel de Control simple para gestionar el cuello de botella de la verificaci√≥n bancaria.

M√≥dulo del Panel	Prop√≥sito	Tablas Utilizadas	Acciones del Admin
Pedidos Pendientes	Muestra todos los registros con estado = 'PENDIENTE_VERIFICACION'.	usuarios_suscripciones, users, planes	1. Descargar comprobante_url. 2. Verificar el banco. 3. Activar/Rechazar.
Activaci√≥n	Se ejecuta al confirmar el pago.	users, usuarios_suscripciones	1. usuarios_suscripciones.estado ‚Üí 'ACTIVO'. 2. users.rol ‚Üí 'editor'. 3. Disparo de Notificaci√≥n (Email/SMS/WhatsApp).
Cuentas por Vencer	Muestra suscripciones donde fecha_vencimiento est√° cerca (e.g., pr√≥ximos 15 d√≠as).	usuarios_suscripciones	Permite enviar recordatorios de renovaci√≥n al id_usuario_principal.
Desactivaci√≥n	Automatizada (Cron Job).	users, usuarios_suscripciones	Si NOW() > fecha_vencimiento Y estado = 'ACTIVO', el sistema autom√°ticamente: users.rol ‚Üí 'EXPIRADO'.

Exportar a Hojas de c√°lculo
Este dise√±o asegura que el rol 'editor' solo se asigne si hay una suscripci√≥n ACTIVA y un registro de pago verificado asociado.
